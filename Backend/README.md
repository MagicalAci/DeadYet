# ğŸ‚ è¿˜æ²¡æ­»ï¼ŸAPI åç«¯

> æ‰“å·¥äººçš„æ¯’èˆŒä¸‹ç­ç­¾åˆ°APPåç«¯æœåŠ¡

## æŠ€æœ¯æ ˆ

- **è¿è¡Œæ—¶**: Node.js 20
- **æ¡†æ¶**: Hono
- **æ•°æ®åº“**: PostgreSQL + Drizzle ORM
- **ç¼“å­˜**: Redis
- **AI**: OpenAI API
- **é‚®ä»¶**: Resend
- **éƒ¨ç½²**: Zeabur

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„é…ç½®
```

### 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

æœåŠ¡å°†åœ¨ http://localhost:3000 å¯åŠ¨

## API æ¥å£

### è®¤è¯

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| POST | `/api/auth/email` | é‚®ç®±ç™»å½•/æ³¨å†Œ |
| GET | `/api/auth/me` | è·å–å½“å‰ç”¨æˆ· |
| PUT | `/api/auth/me` | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ |

### ç­¾åˆ°

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| POST | `/api/checkin` | æ‰§è¡Œç­¾åˆ° |
| GET | `/api/checkin/history` | ç­¾åˆ°å†å² |
| GET | `/api/checkin/today` | ä»Šæ—¥ç­¾åˆ°çŠ¶æ€ |

### åœ°å›¾

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| GET | `/api/map/stats` | å…¨å›½åŸå¸‚ç»Ÿè®¡ |
| GET | `/api/map/city/:name` | åŸå¸‚è¯¦æƒ… |
| GET | `/api/map/heatmap` | çƒ­åŠ›å›¾æ•°æ® |

### æŠ±æ€¨

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| GET | `/api/complaints` | è·å–æŠ±æ€¨åˆ—è¡¨ |
| POST | `/api/complaints` | å‘å¸ƒæŠ±æ€¨ |
| POST | `/api/complaints/:id/like` | ç‚¹èµ |
| GET | `/api/complaints/hot/list` | çƒ­é—¨æŠ±æ€¨ |

### AI

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| POST | `/api/ai/roast` | ç”Ÿæˆæ¯’èˆŒå›å¤ |
| GET | `/api/ai/checkin-response` | ç­¾åˆ°å›å¤ |
| POST | `/api/ai/banner-text` | é”¦æ——æ–‡æ¡ˆ |

### æ¨é€

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| GET | `/api/push/status` | æ¨é€çŠ¶æ€ |
| GET | `/api/push/battle-report` | æˆ˜å†µæŠ¥å‘Š |
| POST | `/api/push/register-device` | æ³¨å†Œè®¾å¤‡ |
| PUT | `/api/push/settings` | æ¨é€è®¾ç½® |

## æ•°æ®åº“è¿ç§»

```bash
# ç”Ÿæˆè¿ç§»æ–‡ä»¶
npm run db:generate

# åº”ç”¨è¿ç§»
npm run db:push

# æ‰“å¼€æ•°æ®åº“ç®¡ç†ç•Œé¢
npm run db:studio
```

## éƒ¨ç½²åˆ° Zeabur

1. åœ¨ Zeabur åˆ›å»ºæ–°é¡¹ç›®
2. æ·»åŠ  PostgreSQL æœåŠ¡
3. æ·»åŠ  Redis æœåŠ¡ï¼ˆå¯é€‰ï¼‰
4. ä» GitHub éƒ¨ç½²æ­¤ä»“åº“
5. é…ç½®ç¯å¢ƒå˜é‡
6. å®Œæˆï¼

## æ¨é€é¢‘ç‡

| æ—¶é—´æ®µ | é¢‘ç‡ | ç´§æ€¥ç¨‹åº¦ |
|--------|------|----------|
| 18:00-21:00 | æ¯å°æ—¶ | ğŸ“Š å¸¸è§„ |
| 21:00-23:00 | æ¯30åˆ†é’Ÿ | âš ï¸ ç´§æ€¥ |
| 23:00-06:00 | æ¯15åˆ†é’Ÿ | ğŸš¨ æ·±å¤œ |

---

**ç¥æ‰“å·¥äººæ—©æ—¥è´¢åŠ¡è‡ªç”±ï¼** ğŸ’ª

